# パーフェクト Ruby 第2版

## トップレベル
クラスの定義式やモジュールの定義式の外をトップレベルと呼ぶ。

#### 特徴
* メソッド呼び出しの際レシーバを記述しない
* 関数の用に、どこからでもグローバルに呼び出すことができる

## ローカル変数
先頭が小文字のアルファベットかアンダースコアで始まる。
以下をスコープ。

* ブロック
* メソッド定義
* クラス・モジュール定義
* トップレベル

スコープ外を参照しようとするとエラーになる。
例えば、メソッド外で定義されたローカル変数をメソッドの中で参照できない。
ブロック外で定義されたものはブロックでも参照できる。
ブロック内のものは外で参照できない。

## 定数
変化しない値を扱う際に定数を使う。
同じ定数に再代入すると、エラーは出ないが警告が出る。
メソッドの中で定数を定義すると、`dynamic constant assignment(SyntaxError)`が出る。

## self
メソッドの中で、そのメソッドが属しているインスタンスを`self`という名前の擬似変数で参照できる（他の言語でのthisのようなもの）。

## 初期化
クラスの初期化は`initialize`メソッドで行う。

## クラスメソッド
メソッドの前に`self.`をつけて定義する。

* `class_method.rb` 参照
クラスメソッドの中での`self`は、そのメソッドが属するクラスになる。
したがって、`Ruler.pair`の中では`Ruler.new`の代わりに、`self.new`と書くこともできる。

## クラス変数
クラスとそのインスタンスをスコープとした変数のこと。
`@@変数`で表記する。
クラス変数はクラス定義の中やクラスメソッド、クラスメソッドから参照できる。

## 継承
Rubyでは単一継承をサポートしている。
継承された方をスーパークラス、継承した方をサブクラスという。
以下の形式。

```
class サブクラス名 < スーパークラス名
end
```

サブクラスにはスーパークラスに定義されたメソッドが継承される。
スーパークラスで既に定義されているメソッドをサブクラスで再び定義することを、メソッドの`オーバーライド`という。
`super`を使うと、スーパークラスに定義されている同じ名前のメソッドが呼び出せる。

## モジュール

Rubyといえばこいつ。`インスタンスを生成できないクラスのようなもの`。
以下の形式。

```
module モジュール名
end
```

#### 特徴
* あるクラスのインスタンスメソッドとして取り込む
* あるオブジェクトのメソッドとして取り込む
* モジュール関数として使う

```
module Brainfsck
  class Parser
  end
end

module Whitespace
  class Parser
  end
end

# ::を用いて参照する
Brainfsck::Parser
Whitespace::Parser
```
